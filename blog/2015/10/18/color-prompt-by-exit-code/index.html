<!doctype html>
    <html >
      <head>
        <meta charset="utf-8">
        <meta name="viewport" content="initial-scale=1">
        <title data-react-helmet="true">Color prompt by exit code - Shuhei Kagawa</title>
        <link rel="icons" sizes="16x16 32x32 48x48" href="/favicon.ico">
        <link rel="alternate" type="application/rss+xml" title="RSS Feed for shuheikagawa.com" href="/blog/feed/rss.xml">
        <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Asap:4000,700">
        <link rel="stylesheet" href="/css/style.css">
        <script>
          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

          ga('create', 'UA-309586-8', 'shuheikagawa.com');
          ga('send', 'pageview');
        </script>
      </head>
      <body>
        <div id="container"><div data-reactroot="" data-reactid="1" data-react-checksum="-1660726157"><header class="header" data-reactid="2"><h1 class="header__title" data-reactid="3"><a href="/" data-reactid="4">Shuhei Kagawa</a></h1><nav data-reactid="5"><ul class="menu" data-reactid="6"><li class="menu__item" data-reactid="7"><a href="/about/" data-reactid="8">About</a></li><li class="menu__item" data-reactid="9"><a href="/works/" data-reactid="10">Works</a></li><li class="menu__item" data-reactid="11"><a href="/blog/archives/" data-reactid="12">Archives</a></li></ul></nav></header><div class="main" data-reactid="13"><div data-reactid="14"><!-- react-empty: 15 --><div class="post" data-reactid="16"><div class="post-header" data-reactid="17"><h1 class="title" data-reactid="18"><a href="/blog/2015/10/18/color-prompt-by-exit-code/" data-reactid="19">Color prompt by exit code</a></h1><div class="meta" data-reactid="20"><!-- react-text: 21 -->@<!-- /react-text --><span class="date" data-reactid="22">2015-10-18 19:11</span><!-- react-text: 23 --> - <!-- /react-text --><span class="category" data-reactid="24">Bash</span></div></div><div class="content" data-reactid="25"><div data-reactid="26"><p>The idea of customizing bash prompt hooked me a few months ago. I tried a few crazy things like <a href="https://github.com/shuhei/dotfiles/commit/a45d8c88d4c02737dad397b56624895bb715f5b5">showing random emojis</a> and finally settled down with just showing the current directory, git branch and status.</p>
<p>At <a href="http://nodejs.connpass.com/event/20646/">Tokyo Node Gakuen #18</a> on October 8th, <a href="https://twitter.com/yosuke_furukawa">@yosuke_furukawa</a> <a href="https://speakerdeck.com/yosuke_furukawa/node-dot-js-v4-falsehua-number-tng18">talked about Node.js v4.0</a>. Aside from the well-organized and informative talk, I found another interesting thing at his demo. His terminal prompt <em>turned red when a command failed</em>.</p>
<p>It looked pretty and useful. So I emulated it.</p>
<p><img src="/images/prompt-exit-code.gif" alt="Changing prompt color "></p>
<p>The code in <code>.bash_profile</code> is pretty straightforward. It changes the prompt color depending on whether the exit code is 0 or not. The only one trick is to capture the exit code at the very first line of the prompt command to prevent it from being changed in prior lines.</p>
<pre><code class="hljs sh"><span class="hljs-comment"># Colors</span>
light_green=<span class="hljs-string">"\[\e[1;32m\]"</span>
light_red=<span class="hljs-string">"\[\e[1;31m\]"</span>
yellow=<span class="hljs-string">"\[\e[0;33m\]"</span>
gray=<span class="hljs-string">"\[\e[0;37m\]"</span>
reset=<span class="hljs-string">"\[\e[m\]"</span>

<span class="hljs-comment"># Customize prompt</span>
<span class="hljs-function"><span class="hljs-title">prompt_command</span></span>() {
  <span class="hljs-built_in">local</span> status=<span class="hljs-string">"$?"</span>
  <span class="hljs-built_in">local</span> status_color=<span class="hljs-string">""</span>
  <span class="hljs-keyword">if</span> [ <span class="hljs-variable">$status</span> != <span class="hljs-number">0</span> ]; <span class="hljs-keyword">then</span>
    status_color=<span class="hljs-variable">$light_red</span>
  <span class="hljs-keyword">else</span>
    status_color=<span class="hljs-variable">$light_green</span>
  <span class="hljs-keyword">fi</span>
  <span class="hljs-built_in">export</span> PS1=<span class="hljs-string">"[<span class="hljs-variable">${yellow}</span>\w<span class="hljs-variable">${reset}</span>]<span class="hljs-variable">${gray}</span><span class="hljs-variable">$(__git_ps1)</span><span class="hljs-variable">${reset}</span> <span class="hljs-variable">${status_color}</span>λ<span class="hljs-variable">${reset}</span> "</span>
}
<span class="hljs-built_in">export</span> GIT_PS1_SHOWDIRTYSTATE=<span class="hljs-number">1</span>
<span class="hljs-built_in">export</span> PROMPT_COMMAND=prompt_commandsh</code></pre><p>One of the advantages of attending real events over just browsing slides online is being able to take a peek of other people&#39;s dev environments. Looking forward to seeing more cool stuff on upcoming events like <a href="http://nodefest.jp/2015/">Tokyo Node Fest 2015</a>.</p>
</div></div></div><div class="comments" data-reactid="27"><div id="disqus_thread" data-reactid="28"></div><noscript data-reactid="29"><!-- react-text: 30 -->Please enable JavaScript to view the<!-- /react-text --><a href="https://disqus.com/?ref_noscript" rel="nofollow" data-reactid="31">comments powered by Disqus.</a></noscript></div></div></div><footer class="footer" data-reactid="32"><!-- react-text: 33 -->© <!-- /react-text --><!-- react-text: 34 -->Shuhei Kagawa<!-- /react-text --></footer></div></div>
        <script><!--
          window.__PRELOADED_PROPS__ = {"site":{"title":"Shuhei Kagawa","author":"Shuhei Kagawa","perPage":3,"newPageExtension":"markdown","blogDir":"blog","sourceDir":"source","layoutDir":"_layouts","postDir":"_posts"},"post":{"layout":"post","title":"Color prompt by exit code","date":"2015-10-18 19:11","comments":true,"categories":["Bash"],"url":"/blog/2015/10/18/color-prompt-by-exit-code/","content":"<p>The idea of customizing bash prompt hooked me a few months ago. I tried a few crazy things like <a href=\"https://github.com/shuhei/dotfiles/commit/a45d8c88d4c02737dad397b56624895bb715f5b5\">showing random emojis</a> and finally settled down with just showing the current directory, git branch and status.</p>\n<p>At <a href=\"http://nodejs.connpass.com/event/20646/\">Tokyo Node Gakuen #18</a> on October 8th, <a href=\"https://twitter.com/yosuke_furukawa\">@yosuke_furukawa</a> <a href=\"https://speakerdeck.com/yosuke_furukawa/node-dot-js-v4-falsehua-number-tng18\">talked about Node.js v4.0</a>. Aside from the well-organized and informative talk, I found another interesting thing at his demo. His terminal prompt <em>turned red when a command failed</em>.</p>\n<p>It looked pretty and useful. So I emulated it.</p>\n<p><img src=\"/images/prompt-exit-code.gif\" alt=\"Changing prompt color \"></p>\n<p>The code in <code>.bash_profile</code> is pretty straightforward. It changes the prompt color depending on whether the exit code is 0 or not. The only one trick is to capture the exit code at the very first line of the prompt command to prevent it from being changed in prior lines.</p>\n<pre><code class=\"hljs sh\"><span class=\"hljs-comment\"># Colors</span>\nlight_green=<span class=\"hljs-string\">\"\\[\\e[1;32m\\]\"</span>\nlight_red=<span class=\"hljs-string\">\"\\[\\e[1;31m\\]\"</span>\nyellow=<span class=\"hljs-string\">\"\\[\\e[0;33m\\]\"</span>\ngray=<span class=\"hljs-string\">\"\\[\\e[0;37m\\]\"</span>\nreset=<span class=\"hljs-string\">\"\\[\\e[m\\]\"</span>\n\n<span class=\"hljs-comment\"># Customize prompt</span>\n<span class=\"hljs-function\"><span class=\"hljs-title\">prompt_command</span></span>() {\n  <span class=\"hljs-built_in\">local</span> status=<span class=\"hljs-string\">\"$?\"</span>\n  <span class=\"hljs-built_in\">local</span> status_color=<span class=\"hljs-string\">\"\"</span>\n  <span class=\"hljs-keyword\">if</span> [ <span class=\"hljs-variable\">$status</span> != <span class=\"hljs-number\">0</span> ]; <span class=\"hljs-keyword\">then</span>\n    status_color=<span class=\"hljs-variable\">$light_red</span>\n  <span class=\"hljs-keyword\">else</span>\n    status_color=<span class=\"hljs-variable\">$light_green</span>\n  <span class=\"hljs-keyword\">fi</span>\n  <span class=\"hljs-built_in\">export</span> PS1=<span class=\"hljs-string\">\"[<span class=\"hljs-variable\">${yellow}</span>\\w<span class=\"hljs-variable\">${reset}</span>]<span class=\"hljs-variable\">${gray}</span><span class=\"hljs-variable\">$(__git_ps1)</span><span class=\"hljs-variable\">${reset}</span> <span class=\"hljs-variable\">${status_color}</span>λ<span class=\"hljs-variable\">${reset}</span> \"</span>\n}\n<span class=\"hljs-built_in\">export</span> GIT_PS1_SHOWDIRTYSTATE=<span class=\"hljs-number\">1</span>\n<span class=\"hljs-built_in\">export</span> PROMPT_COMMAND=prompt_commandsh</code></pre><p>One of the advantages of attending real events over just browsing slides online is being able to take a peek of other people&#39;s dev environments. Looking forward to seeing more cool stuff on upcoming events like <a href=\"http://nodefest.jp/2015/\">Tokyo Node Fest 2015</a>.</p>\n"}};
        --></script>
        <script src="/js/index.js"></script>
      </body>
    </html>