<!DOCTYPE html><html><head><title>Page 3 - Shuhei Kagawa</title><meta charset="utf-8"><meta name="viewport" content="initial-scale=1"><link rel="icon" sizes="16x16 32x32 48x48" href="/favicon.ico"><link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Asap:400,700"><link rel="stylesheet" href="/css/style.css"></head><body><header class="header"><h1 class="header__title"><a href="/">Shuhei Kagawa</a></h1><nav><ul class="menu"><li class="menu__item"><a href="/about">About</a></li><li class="menu__item"><a href="/works">Works</a></li><li class="menu__item"><a href="/blog/archives">Archives</a></li></ul></nav></header><div class="main"><div class="post"><div class="post-header"><h1 class="title"><a href="/blog/2016/01/11/freeze-panes-with-css-and-a-bit-of-javascript">Freeze panes with CSS and a bit of JavaScript</a></h1><div class="meta">@<span class="date">2016-01-11 11:24</span> - <span class="category">CSS</span>, <span class="category">JavaScript</span></div></div><div class="content"><p>People want fixed-header table. It reminds you what the columns are while you scroll down the table. There are a bunch of fixed-header-table tutorials out there. But most of them kill one of the greatest features of HTML table. The automatic sizing of cells according to their contents. This is because they usually prepare separate <code>&lt;table&gt;</code>s for header and body.</p>
<p>Also, most of the tutorials only fix a header at the top. But my colleagues wanted more. They wanted to fix headers at the top and left. Just like <a href="http://www.gcflearnfree.org/excel2013/17">Microsoft Excel&#39;s Freeze Panes feature</a>. So what we want now is:</p>
<ol>
<li>Automatic sizing of cells according to their contents</li>
<li>Freeze panes</li>
</ol>
<p>We want to use only one <code>&lt;table&gt;</code> to easily achive the goal 1. But at the same time, we want to separate the movement of the headers from other cells to achieve the goal 2. Then <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/transform">CSS3&#39;s <code>transform</code> property</a> came to my mind. It allows you to transform <strong>only rendering</strong> of an element without interfering its sibling nodes.</p>
<p>So I gave it a shot and here&#39;s the result.</p>
<p><a class="jsbin-embed" href="http://jsbin.com/katabi/embed?output">JS Bin on jsbin.com</a><script src="http://static.jsbin.com/js/embed.min.js?3.35.9"></script></p>
<h2 id="transform-translate-">transform: translate()</h2>
<p>I used JavaScript to dynamically set <code>transform: translate(x, y);</code> to the header cells sending them back to the top/left edge of the container.</p>
<pre><code class="hljs js">container.addEventListener(<span class="hljs-string">'scroll'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">var</span> x = container.scrollLeft;
  <span class="hljs-keyword">var</span> y = container.scrollTop;

  leftHeaders.forEach(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">leftHeader</span>) </span>{
    leftHeader.style.transform = translate(x, <span class="hljs-number">0</span>);
  });
  topHeaders.forEach(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">topHeader, i</span>) </span>{
    <span class="hljs-keyword">if</span> (i === <span class="hljs-number">0</span>) {
      topHeader.style.transform = translate(x, y);
    } <span class="hljs-keyword">else</span> {
      topHeader.style.transform = translate(<span class="hljs-number">0</span>, y);
    }
  });
});

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">translate</span>(<span class="hljs-params">x, y</span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-string">'translate('</span> + x + <span class="hljs-string">'px, '</span> + y + <span class="hljs-string">'px)'</span>;
}</code></pre><h2 id="border-collapse-separate-">border-collapse: separate;</h2>
<p>Another trick is <code>border-collapse: separate;</code>. We usually use <code>border-collapse: collapse;</code> for tables but it leaves borders behind the cells. With <code>border-collapse: collapse;</code>, we can make the borders transformed together with the header cells.</p>
<pre><code class="hljs css"><span class="hljs-tag">table</span> <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">border-collapse</span>:<span class="hljs-value"> separate</span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">border-spacing</span>:<span class="hljs-value"> <span class="hljs-number">0</span></span></span>;
}</span>

<span class="hljs-tag">th</span>,
<span class="hljs-tag">td</span> <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">border-bottom</span>:<span class="hljs-value"> <span class="hljs-number">1px</span> solid <span class="hljs-hexcolor">#ccc</span></span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">border-right</span>:<span class="hljs-value"> <span class="hljs-number">1px</span> solid <span class="hljs-hexcolor">#ccc</span></span></span>;
}</span></code></pre><h2 id="dummy-top-left-header-cell">Dummy top left header cell</h2>
<p>The last trick is a kind of shame. It&#39;s the top left header cell that should be fixed horizontally and vertically. We can achieve it by the <code>transform</code> property but the other top header cells hides it. I tried to make it rise with <code>z-index</code> but didn&#39;t work. So I created a dummy element that had the same size with the cell.</p>
<pre><code class="hljs js"><span class="hljs-keyword">var</span> topLeft = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">'div'</span>);
<span class="hljs-keyword">var</span> computed = <span class="hljs-built_in">window</span>.getComputedStyle(columnHeaders[<span class="hljs-number">0</span>]);
container.appendChild(topLeft);
topLeft.classList.add(<span class="hljs-string">'top-left'</span>);
topLeft.style.width = computed.width;
topLeft.style.height = computed.height;</code></pre><pre><code class="hljs css"><span class="hljs-class">.top-left</span> <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">background</span>:<span class="hljs-value"> <span class="hljs-hexcolor">#eee</span></span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">border-right</span>:<span class="hljs-value"> <span class="hljs-number">1px</span> solid <span class="hljs-hexcolor">#ccc</span></span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">border-bottom</span>:<span class="hljs-value"> <span class="hljs-number">1px</span> solid <span class="hljs-hexcolor">#ccc</span></span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">box-sizing</span>:<span class="hljs-value"> border-box</span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">position</span>:<span class="hljs-value"> absolute</span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">top</span>:<span class="hljs-value"> <span class="hljs-number">0</span></span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">left</span>:<span class="hljs-value"> <span class="hljs-number">0</span></span></span>;
}</span></code></pre><h2 id="compatibility-and-performance">Compatibility and performance</h2>
<p>As far as I&#39;ve tested with the latest Chrome, Firefox and Safari on Mac, it worked well without any performance issue. I&#39;ll test it with more large table on other browsers including IE and add the result later.</p>
</div></div><div class="post"><div class="post-header"><h1 class="title"><a href="/blog/2015/11/29/algorithms-part-1">Algorithms: Design and Analysis, Part 1</a></h1><div class="meta">@<span class="date">2015-11-29 23:35</span> - <span class="category">Algorithms</span></div></div><div class="content"><p>Today I finished the final exam of Stanford&#39;s <a href="https://www.coursera.org/course/algo">&quot;Algorithms: Design and Analysis, Part 1&quot;</a> at Coursera. I solved all its programming assignments with JavaScript and put the solutions at GitHub:</p>
<ul>
<li><a href="https://github.com/shuhei/algo">shuhei/algo</a></li>
</ul>
<p>The course focused on fundamental algorithms and their analysis. What I learned so far were:</p>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Divide_and_conquer_algorithms">Divide-and-conquer algorithms</a> and analysis with <a href="https://en.wikipedia.org/wiki/Master_theorem">Master Method</a>: <a href="https://en.wikipedia.org/wiki/Merge_sort">merge sort</a> and <a href="https://en.wikipedia.org/wiki/Quicksort">quick sort</a></li>
<li>Graph algorithms: <a href="https://en.wikipedia.org/wiki/Minimum_cut">minimum cut</a>, <a href="https://en.wikipedia.org/wiki/Depth-first_search">depth-first</a> and <a href="https://en.wikipedia.org/wiki/Breadth-first_search">breadth-first</a> search, <a href="https://en.wikipedia.org/wiki/Strongly_connected_component">strongly connected components</a>, <a href="https://en.wikipedia.org/wiki/Dijkstra%27s_algorithm">Dijkstra&#39;s shortest-path</a></li>
<li>Data structures: <a href="https://en.wikipedia.org/wiki/Heap_(data_structure">heaps</a>, <a href="https://en.wikipedia.org/wiki/Hash_table">hash tables</a> and <a href="https://en.wikipedia.org/wiki/Binary_search_tree">binary search trees</a></li>
</ul>
<p>As a self-taught programmer, I had been away from formal Computer Science topics like big O notation. But after I learned <a href="https://www.coursera.org/learn/machine-learning">Machine Learning</a> and tried to implement some ML algorithms for large datasets a few months ago, I noticed that I needed some knowledge of basic algorithms and mathematical analysis of them.</p>
<p>The Algorithms course focused not only on algorithms themselves but also on their performance analysis and mathematical proofs. The analysis and proofs are crucial especially for the cases when we design custom algorithms for real-world problems in the future, and more importantly made me more confident about the algorithms.</p>
<p>Another good side effect of the course was that I got interested in Mathematics. Through the course and a study meetings on <a href="https://mitpress.mit.edu/sicp/">SICP</a> with my co-workers, I noticed that Mathematics is interesting but I lacked some prerequisites to understand it. At the moment, I came across <a href="http://www.amazon.com/Introduction-Mathematical-Thinking-Keith-Devlin/dp/0615653634">Introduction to Mathematical Thinking</a> by Keith Devlin. It was written to fill the gap between the school math, which focuses following given procedures, and the college math, which focuses on thinking. It is perfect for someone like me, who skipped proper Mathematics training at college. I am still on the way reading it but it already started working on my analysis of the SICP exercises.</p>
<p><a href="https://www.coursera.org/course/algo2">The part 2 of the course</a> will start probably on March 2016. I cannot wait for it to start and get my eyes open again.</p>
</div></div><div class="post"><div class="post-header"><h1 class="title"><a href="/blog/2015/10/25/node-executable-module">Node.js executable module</a></h1><div class="meta">@<span class="date">2015-10-25 22:42</span> - <span class="category">JavaScript</span></div></div><div class="content"><p>You may want to create a Node module that is also an executable. The convention is to create two files, one for lib and the other for bin, but I think it&#39;s OK for simple modules.</p>
<p>To achieve it, you need to detect whether it&#39;s executed as an entry point. According to <a href="https://nodejs.org/api/modules.html#modules_accessing_the_main_module">the official documentation of Node</a>:</p>
<blockquote>
<p>When a file is run directly from Node.js, <code>require.main</code> is set to its module. That means that you can determine whether a file has been run directly by testing</p>
<pre><code class="hljs undefined">require.main === module</code></pre></blockquote>
<p>For example:</p>
<pre><code class="hljs js">#!/usr/bin/env node

function sum(a, b) {
  return a + b;
}

module.exports = sum;

if (require.main === module) {
  var a = parseInt(process.argv[2], 10);
  var b = parseInt(process.argv[3], 10);
  console.log(sum(a, b));
}</code></pre><p>Then you can use it as an executable and a module.</p>
<pre><code class="hljs sh">$ node sum.js <span class="hljs-number">3</span> <span class="hljs-number">4</span>
<span class="hljs-number">7</span>
$ node
&gt; require(<span class="hljs-string">'./sum'</span>)(<span class="hljs-number">3</span>, <span class="hljs-number">4</span>)
<span class="hljs-number">7</span></code></pre></div></div><ul class="pagination"><li class="pagination__prev-page"><a href="/blog/pages/2">Newer Posts</a></li><li class="pagination__archives"><a href="/blog/archives">Archives</a></li><li class="pagination__next-page"><a href="/blog/pages/4">Older Posts</a></li></ul></div><footer class="footer">&copy; Shuhei Kagawa<script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-309586-8', 'shuheikagawa.com');
ga('send', 'pageview');</script></footer></body></html>