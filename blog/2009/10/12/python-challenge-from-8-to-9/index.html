<!DOCTYPE html><html><head><title>Shuhei Kagawa</title><meta charset="utf-8"><meta name="viewport" content="initial-scale=1"><link rel="icon" sizes="16x16 32x32 48x48" href="/favicon.ico"><link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Asap:400,700"><link rel="stylesheet" href="/css/style.css"></head><body><header class="header"><h1 class="title"><a href="/">Shuhei Kagawa</a></h1><nav><ul><li><a href="/blog/archives">Archives</a></li><li><a href="/about">About</a></li></ul></nav></header><div class="main"><div class="post"><div class="post-header"><h1 class="title"><a href="/blog/2009/10/12/python-challenge-from-8-to-9">Python Challenge Lv. 8 - 9</a></h1><div class="meta">@<span class="date">2009-10-12 17:57</span> - </div></div><div class="content"><h3>Level 8</h3>
<p>とりあえず <code>&lt;area&gt;</code> タグの <code>coords</code> 属性を描いてみました。Ruby と <a href="/blog/2009/10/12/install-cairo-with-gem/">苦労してインストールした cairo</a> を使用。</p>
<pre class="prettyprint">require 'cairo'

nums = [179,284,214,311,255,320,281,226,319,224,363,309,339,222,371,225,411,229,404,242,415,252,428,233,428,214,394,207,383,205,390,195,423,192,439,193,442,209,440,215,450,221,457,226,469,202,475,187,494,188,494,169,498,147,491,121,477,136,481,96,471,94,458,98,444,91,420,87,405,92,391,88,376,82,350,79,330,82,314,85,305,90,299,96,290,103,276,110,262,114,225,123,212,125,185,133,138,144,118,160,97,168,87,176,110,180,145,176,153,176,150,182,137,190,126,194,121,198,126,203,151,205,160,195,168,217,169,234,170,260,174,282]
points = []
while nums.size &gt; 0 do
  points.push nums.slice!(0, 2)
end

def draw_points(points, width, height, filename)
  format = Cairo::FORMAT_ARGB32
  surface = Cairo::ImageSurface.new(format, width, height)
  context = Cairo::Context.new(surface)

  context.set_source_rgb(1, 1, 1)
  context.rectangle(0, 0, width, height)
  context.fill

  context.set_source_rgb(0, 0, 0)
  context.move_to(points[0][0], points[0][1])
  points.each do |p|
    context.line_to p[0], p[1]
  end
  context.stroke

  surface.write_to_png(filename)
end

draw_points(points, 640, 480, "fly.png")</pre>
<p>しかし、ただの蠅の輪郭です。リンク部分の形ですね。<br />
で、今度は un 文字列を座標に見立てて線を引いてみたりしたのですが・・・。</p>
<pre class="prettyprint">un = "BZh91AY&amp;SYA\xaf\x82\r\x00\x00\x01\x01\x80\x02\xc0\x02\x00 \x00!\x9ah3M\x07&lt;]\xc9\x14\xe1BA\x06\xbe\x084"
un_points = []
0.step(un.size - 1, 2) do |i|
  un_points.push([un[i], un[i + 1]])
end

draw_points(points, 640, 480, "un.png")</pre>
<p>全然違うようです・・・。こりゃあかんということで、フォーラムにヒントを見に行くと、Python のモジュールを探せ、unとpwの形式をよく見ろとのこと。<br />
共通する「BZh91AY&amp;S」でググってみたところ、bzip2 のヘッダ部分だとか。知らんがな。<br />
ということで、Python の bz2 モジュールで解凍して答えを得ました。</p>
<pre class="prettyprint">&gt;&gt;&gt; import bz2
&gt;&gt;&gt; un = "BZh91AY&amp;SYA\xaf\x82\r\x00\x00\x01\x01\x80\x02\xc0\x02\x00 \x00!\x9ah3M\x07&lt;]\xc9\x14\xe1BA\x06\xbe\x084"
&gt;&gt;&gt; pw = "BZh91AY&amp;SY\x94$|\x0e\x00\x00\x00\x81\x00\x03$ \x00!\x9ah3M\x13&lt;]\xc9\x14\xe1BBP\x91\xf08"
&gt;&gt;&gt; bz2.decompress(pw)
'file'
&gt;&gt;&gt; bz2.decompress(un)
'huge'</pre>
<h3>Level 9</h3>
<p>Level 7 でやってみたのは、こっちの解法だったようです。<br />
ということで、以下。</p>
<pre class="prettyprint">require 'cairo'

first = [略]
second = [略]

first_points = []
while first.size &gt; 0 do
   first_points.push first.slice!(0, 2)
end

second_points = []
while second.size &gt; 0 do
   second_points.push second.slice!(0, 2)
end

draw_points(first_points, 495, 495, "first.png")
draw_points(second_points, 495, 495, "second.png")</pre>
<p><a href="http://www.flickr.com/photos/branchiopoda/4004511454/" title="first by shuhei kagawa, on Flickr"><img src="http://farm3.static.flickr.com/2436/4004511454_85bdd6eabe_o.png" width="495" height="495" alt="first" /></a></p>
<p>ということで、出てきた動物の名前をいくつか適当に入れると正解に。<br />
しかし、まだまだ四分の一。先は長いです・・・。</p></div></div></div><footer class="footer">&copy; Shuhei Kagawa<script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-309586-8', 'shuheikagawa.com');
ga('send', 'pageview');</script></footer></body></html>