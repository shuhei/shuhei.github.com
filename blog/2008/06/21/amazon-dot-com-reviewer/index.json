{"site":{"title":"Shuhei Kagawa","author":"Shuhei Kagawa","perPage":3,"newPageExtension":"markdown","blogDir":"blog","sourceDir":"source","layoutDir":"_layouts","postDir":"_posts","cssFiles":["node_modules/highlight.js/styles/monokai-sublime.css","source/_css/style.css"]},"post":{"layout":"post","title":"Amazon.co.jp の洋書レビューを Amazon.com で見るための Greasemonkey","published":true,"date":"2008-06-21 23:58","comments":true,"tags":null,"categories":["Greasemonkey"],"url":"/blog/2008/06/21/amazon-dot-com-reviewer/","content":"<p>Amazon.co.jp で洋書を見ると、レビューがほとんどありません。\n一方、Amazon.com に行けばレビューがたくさんあります。\nですが同じ本のページを探すのに、 ISBN をコピペしたり検索し直したりするのは、ちょっとした手間ですね。</p>\n<p>そこで、Greasemonkey のuser script を書いてみました。</p>\n<p>本の題名のすぐ下に、リンクができます。\namazon.co.jp からは amazon.com の、amazon.com からは amazon.co.jp の、それぞれ同じ本のページへのリンクです。\n洋書のレビューを amazon.com で探したり、また amazon.com で見つけた本を amazon.co.jp で買う際に地味に便利です。</p>\n<p>amazondotcomreviewer.user.js</p>\n<pre><code class=\"hljs js\"><span class=\"hljs-comment\">// ==UserScript==</span>\n<span class=\"hljs-comment\">// @name           AmazonDotComReviewer 0.1</span>\n<span class=\"hljs-comment\">// @namespace      http://www.7to3.net</span>\n<span class=\"hljs-comment\">// @description    Make link between amazon.com and amazon.co.jp</span>\n<span class=\"hljs-comment\">// @include        http://*.amazon.*</span>\n<span class=\"hljs-comment\">// ==/UserScript==</span>\n\n(<span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\"></span>) </span>{\n    <span class=\"hljs-keyword\">var</span> isbnmatch = <span class=\"hljs-built_in\">window</span>.location.href.match(<span class=\"hljs-regexp\">/amazon\\.(com|co\\.jp)\\/.*\\/([0-1][0-9A-Z]{9})\\//</span>);\n    <span class=\"hljs-keyword\">var</span> header = <span class=\"hljs-built_in\">document</span>.getElementById(<span class=\"hljs-string\">'btAsinTitle'</span>);\n\n    <span class=\"hljs-keyword\">if</span> (header &amp;&amp; isbnmatch) {\n        domain = (isbnmatch[<span class=\"hljs-number\">1</span>] === <span class=\"hljs-string\">'com'</span>) ? <span class=\"hljs-string\">'co.jp'</span> : <span class=\"hljs-string\">'com'</span>;\n        isbn = isbnmatch[<span class=\"hljs-number\">2</span>];\n\n        <span class=\"hljs-keyword\">var</span> uslink = <span class=\"hljs-built_in\">document</span>.createElement(<span class=\"hljs-string\">'a'</span>);\n        uslink.setAttribute(<span class=\"hljs-string\">'href'</span>, <span class=\"hljs-string\">'http://www.amazon.'</span> + domain + <span class=\"hljs-string\">'/o/ASIN/'</span> + isbn + <span class=\"hljs-string\">'/'</span>);\n        uslink.setAttribute(<span class=\"hljs-string\">'title'</span>, <span class=\"hljs-string\">'The same book at amazon.'</span> + domain);\n        uslink.innerHTML = <span class=\"hljs-string\">\"&lt;br /&gt;&amp;#187; Check also amazon.\"</span> + domain + <span class=\"hljs-string\">\"!\"</span>;\n\n        header.insertBefore(uslink, header.firstChild.nextSibling);\n    }\n    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-literal\">false</span>;\n\n}\n)();</code></pre>"}}