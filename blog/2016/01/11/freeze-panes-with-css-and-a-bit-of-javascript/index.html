<!doctype html>
  <html lang="en">
    <head>
      <meta charset="utf-8">
			<link rel="preload" href="https://fonts.googleapis.com/css?family=IBM+Plex+Sans:400,700|Fira+Mono:400&display=swap" as="style">
<link rel="preload" href="https://fonts.gstatic.com/s/firamono/v8/N0bX2SlFPv1weGeLZDtgJv7Ss9XZYQ.woff2" as="font" crossorigin="anonymous">
<link rel="preload" href="https://fonts.gstatic.com/s/ibmplexsans/v7/zYXgKVElMYYaJe8bpLHnCwDKhdHeFaxOedc.woff2" as="font" crossorigin="anonymous">
<link rel="preload" href="https://fonts.gstatic.com/s/ibmplexsans/v7/zYX9KVElMYYaJe8bpLHnCwDKjWr7AIFsdP3pBms.woff2" as="font" crossorigin="anonymous">
      <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <title>Freeze panes with CSS and a bit of JavaScript - Shuhei Kagawa</title>
      <link rel="icons" sizes="16x16 32x32 48x48" href="/favicon.ico">
      <link rel="alternate" type="application/rss+xml" title="RSS Feed for shuheikagawa.com" href="/blog/feed/rss.xml">
      <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-309586-8', 'shuheikagawa.com');
  ga('send', 'pageview');
</script>
      <style>:root{--bg-color:#f7f0e7;--text-color:#2d1e14;--highlight-color:#095ae8;--code-bg-color:hsl(
    var(--syntax-hue),
    var(--syntax-saturation),
    var(--syntax-brightness)
  );--code-text-color:var(--code-mono-1);--syntax-hue:230;--syntax-saturation:1%;--syntax-brightness:100%;--code-mono-1:hsl(var(--syntax-hue), 8%, 24%);--code-mono-2:hsl(var(--syntax-hue), 6%, 44%);--code-mono-3:hsl(var(--syntax-hue), 4%, 64%);--code-hue-1:hsl(198, 99%, 37%);--code-hue-2:hsl(221, 76%, 47%);--code-hue-3:hsl(301, 63%, 40%);--code-hue-4:hsl(119, 72%, 31%);--code-hue-5:hsl(5, 68%, 48%);--code-hue-5-2:hsl(344, 84%, 43%);--code-hue-6:hsl(41, 99%, 30%);--code-hue-6-2:hsl(41, 99%, 30%)}@media (prefers-color-scheme:dark){:root{--bg-color:#312b3a;--text-color:#f7f0e7;--highlight-color:#9dc8fb;--syntax-hue:220;--syntax-saturation:13%;--syntax-brightness:11%;--code-mono-1:hsl(var(--syntax-hue), 14%, 87%);--code-mono-2:hsl(var(--syntax-hue), 9%, 55%);--code-mono-3:hsl(var(--syntax-hue), 10%, 40%);--code-hue-1:hsl(187, 47%, 55%);--code-hue-2:hsl(207, 82%, 66%);--code-hue-3:hsl(286, 60%, 67%);--code-hue-4:hsl(95, 38%, 62%);--code-hue-5:hsl(355, 65%, 65%);--code-hue-5-2:hsl(5, 48%, 51%);--code-hue-6:hsl(29, 54%, 61%);--code-hue-6-2:hsl(39, 67%, 69%)}}body{font-family:"IBM Plex Sans",sans-serif;background:#f7f0e7;background:var(--bg-color);color:#2d1e14;color:var(--text-color);padding:0;margin:0;line-height:1.7}.container{width:700px;padding:0 20px;margin:0 auto}a{color:#095ae8;color:var(--highlight-color);transition:color .5s ease}a:hover{opacity:.7}.header{padding:15px 0 5px;display:flex}.header__title{margin:0 10px 0 0;flex-grow:1}.header__title a{color:#095ae8;color:var(--highlight-color);text-decoration:none}.header__nav{flex-grow:0}.menu{list-style-position:outside;list-style-type:none;padding:15px 0;margin:0}.menu__item{display:inline-block;padding:0 0 0 20px}.menu__item a{color:#2d1e14;color:var(--text-color);text-decoration:none}.footer{padding:50px 0 30px;text-align:center}.title{font-size:42px;margin:0;line-height:1.3}.title a{color:#2d1e14;color:var(--text-color);text-decoration:none}.post,.post-list{padding:30px 0 20px}.post:not(:first-child):before{content:"* * *";font-weight:700;display:block;margin:0 auto 45px;font-size:50px;text-align:center}.post .meta{font-size:small;margin:10px 0 20px}.post-list .title{margin-bottom:10px}.post-list-item{line-height:1.6em;padding:10px 0;display:flex}.post-list-item__date{font-size:small;width:90px;flex-shrink:0}.post-list-item__title{font-size:large;margin:0}.post-list-item__title a{text-decoration:none}.content img{max-width:100%}.responsive-image-wrapper{display:block}.responsive-image-outer{display:block;margin:0 auto}.responsive-image-inner{display:block;position:relative}.responsive-image{position:absolute;top:0;left:0}.social-buttons{margin:2em 0 0}.comments{margin-bottom:3em}ol,ul{list-style-position:outside;padding-left:1.4em}.table-wrapper{overflow-x:auto}table{border-collapse:collapse;margin:2em 0}th{font-weight:400;text-align:left}tbody{border-top:1px solid #333;padding:.5em 0}td,th{padding-right:1em}code{background-color:#fff;background-color:var(--code-bg-color);color:#383942;color:var(--code-text-color);padding:.1em .4em .1em;border-radius:.4em;font-size:.9em;font-family:"Fira Mono",monospace}.code__filename{display:inline-block;margin-bottom:13px;padding:5px 10px;font-size:.85em;background-color:#666}.hljs{display:block;line-height:1.5em;padding:15px 20px;overflow-x:auto;-webkit-overflow-scrolling:touch;background-color:#fff;background-color:var(--code-bg-color);color:#383942;color:var(--code-text-color)}.hljs-comment,.hljs-quote{color:#696b76;color:var(--code-mono-2);font-style:italic}.hljs-doctag,.hljs-formula,.hljs-keyword{color:#a625a4;color:var(--code-hue-3)}.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#cd3527;color:var(--code-hue-5)}.hljs-literal{color:#0083bb;color:var(--code-hue-1)}.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#188716;color:var(--code-hue-4)}.hljs-built_in,.hljs-class .hljs-title{color:#986800;color:var(--code-hue-6-2)}.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#986800;color:var(--code-hue-6)}.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#1c56d2;color:var(--code-hue-2)}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-link{text-decoration:underline}blockquote{border-left:5px solid #2d1e14;border-left:5px solid var(--text-color);font-style:italic;padding:.1em 1.2em;margin-left:0;quotes:"\201C""\201D""\2018""\2019"}blockquote p:first-child:before{content:open-quote;font-family:serif;font-size:3em;font-weight:700;line-height:.1em;margin-right:.2em;vertical-align:-.4em}blockquote cite{color:#999990}blockquote cite:before{content:"- "}.pagination{list-style-position:outside;list-style-type:none;padding:0;margin-top:20px;display:flex;justify-content:space-between}.pagination li{min-height:1em;width:33%}.pagination a{text-decoration:none}.pagination__prev-page a:before{content:"< "}.pagination__next-page{text-align:right}.pagination__next-page a:after{content:" >"}.pagination__archives{flex-grow:1;text-align:center}@media only screen and (max-width:767px){.container{width:auto}.header{display:block}.post,.post-list{padding-top:10px}.title{font-size:24px}.menu__item{padding:0 20px 0 0}.post-list-item{display:block}.hljs{margin-left:-20px;margin-right:-20px;padding:1.4em 20px;border-radius:0}li .hljs{margin-left:0;border-radius:.4em}.responsive-image-wrapper{margin-left:-20px;margin-right:-20px}}</style>
      <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=IBM+Plex+Sans:400,700|Fira+Mono:400&display=swap">
      <meta name="description" content="People want fixed-header table. It reminds you what the columns are while you scroll down the table. There are a bunch of fixed-header-table tutorials out there...">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@shuheikagawa">
<meta property="og:title" content="Freeze panes with CSS and a bit of JavaScript - Shuhei Kagawa">
<meta property="og:site_name" content="Shuhei Kagawa">
<meta property="og:description" content="People want fixed-header table. It reminds you what the columns are while you scroll down the table. There are a bunch of fixed-header-table tutorials out there...">
<meta property="og:image" content="https://shuheikagawa.com/blog/2016/01/11/freeze-panes-with-css-and-a-bit-of-javascript/title.png">
    </head>
    <body>
      <div class="container">
        <header class="header">
          <h1 class="header__title">
            <a href="/">Shuhei Kagawa</a>
          </h1>
          <nav class="header__nav">
            <ul class="menu">
              <li class="menu__item">
                <a href="/about/">About</a>
              </li>
              <li class="menu__item">
                <a href="/blog/archives/">All Posts</a>
              </li>
            </ul>
          </nav>
        </header>
        <div class="main">
          
    
    <div class="post">
      <div class="post-header">
        <h1 class="title">
          <a href=/blog/2016/01/11/freeze-panes-with-css-and-a-bit-of-javascript/>Freeze panes with CSS and a bit of JavaScript</a>
        </h1>
        <div class="meta">
          <span class="date">Jan 11, 2016</span>
          - <span class="category">CSS</span>, <span class="category">JavaScript</span>
        </div>
      </div>
      <div class="content">
        <div>
          <p>People want fixed-header table. It reminds you what the columns are while you scroll down the table. There are a bunch of fixed-header-table tutorials out there. But most of them kill one of the greatest features of HTML table. The automatic sizing of cells according to their contents. This is because they usually prepare separate <code>&lt;table&gt;</code>s for header and body.</p>
<p>Also, most of the tutorials only fix a header at the top. But my colleagues wanted more. They wanted to fix headers at the top and left. Just like <a href="http://www.gcflearnfree.org/excel2013/17">Microsoft Excel&#39;s Freeze Panes feature</a>. So what we want now is:</p>
<ol>
<li>Automatic sizing of cells according to their contents</li>
<li>Freeze panes</li>
</ol>
<p>We want to use only one <code>&lt;table&gt;</code> to easily achive the goal 1. But at the same time, we want to separate the movement of the headers from other cells to achieve the goal 2. Then <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/transform">CSS3&#39;s <code>transform</code> property</a> came to my mind. It allows you to transform <strong>only rendering</strong> of an element without interfering its sibling nodes.</p>
<p>So I gave it a shot and here&#39;s the result.</p>
<p><a href="https://jsbin.com/katabi/edit" target="_blank">JS Bin on jsbin.com</a></p>
<h2 id="transform-translate">transform: translate()</h2>
<p>I used JavaScript to dynamically set <code>transform: translate(x, y);</code> to the header cells sending them back to the top/left edge of the container.</p>
<pre><code class="hljs js">container.addEventListener(<span class="hljs-string">'scroll'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">var</span> x = container.scrollLeft;
  <span class="hljs-keyword">var</span> y = container.scrollTop;

  leftHeaders.forEach(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">leftHeader</span>) </span>{
    leftHeader.style.transform = translate(x, <span class="hljs-number">0</span>);
  });
  topHeaders.forEach(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">topHeader, i</span>) </span>{
    <span class="hljs-keyword">if</span> (i === <span class="hljs-number">0</span>) {
      topHeader.style.transform = translate(x, y);
    } <span class="hljs-keyword">else</span> {
      topHeader.style.transform = translate(<span class="hljs-number">0</span>, y);
    }
  });
});

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">translate</span>(<span class="hljs-params">x, y</span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-string">'translate('</span> + x + <span class="hljs-string">'px, '</span> + y + <span class="hljs-string">'px)'</span>;
}</code></pre><h2 id="border-collapse-separate">border-collapse: separate;</h2>
<p>Another trick is <code>border-collapse: separate;</code>. We usually use <code>border-collapse: collapse;</code> for tables but it leaves borders behind the cells. With <code>border-collapse: collapse;</code>, we can make the borders transformed together with the header cells.</p>
<pre><code class="hljs css"><span class="hljs-selector-tag">table</span> {
  <span class="hljs-attribute">border-collapse</span>: separate;
  <span class="hljs-attribute">border-spacing</span>: <span class="hljs-number">0</span>;
}

<span class="hljs-selector-tag">th</span>,
<span class="hljs-selector-tag">td</span> {
  <span class="hljs-attribute">border-bottom</span>: <span class="hljs-number">1px</span> solid <span class="hljs-number">#ccc</span>;
  <span class="hljs-attribute">border-right</span>: <span class="hljs-number">1px</span> solid <span class="hljs-number">#ccc</span>;
}</code></pre><h2 id="dummy-top-left-header-cell">Dummy top left header cell</h2>
<p>The last trick is a kind of shame. It&#39;s the top left header cell that should be fixed horizontally and vertically. We can achieve it by the <code>transform</code> property but the other top header cells hides it. I tried to make it rise with <code>z-index</code> but didn&#39;t work. So I created a dummy element that had the same size with the cell.</p>
<pre><code class="hljs js"><span class="hljs-keyword">var</span> topLeft = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">'div'</span>);
<span class="hljs-keyword">var</span> computed = <span class="hljs-built_in">window</span>.getComputedStyle(columnHeaders[<span class="hljs-number">0</span>]);
container.appendChild(topLeft);
topLeft.classList.add(<span class="hljs-string">'top-left'</span>);
topLeft.style.width = computed.width;
topLeft.style.height = computed.height;</code></pre><pre><code class="hljs css"><span class="hljs-selector-class">.top-left</span> {
  <span class="hljs-attribute">background</span>: <span class="hljs-number">#eee</span>;
  <span class="hljs-attribute">border-right</span>: <span class="hljs-number">1px</span> solid <span class="hljs-number">#ccc</span>;
  <span class="hljs-attribute">border-bottom</span>: <span class="hljs-number">1px</span> solid <span class="hljs-number">#ccc</span>;
  <span class="hljs-attribute">box-sizing</span>: border-box;
  <span class="hljs-attribute">position</span>: absolute;
  <span class="hljs-attribute">top</span>: <span class="hljs-number">0</span>;
  <span class="hljs-attribute">left</span>: <span class="hljs-number">0</span>;
}</code></pre><h2 id="compatibility-and-performance">Compatibility and performance</h2>
<p>As far as I&#39;ve tested with the latest Chrome, Firefox and Safari on Mac, it worked well without any performance issue. I&#39;ll test it with more large table on other browsers including IE and add the result later.</p>

        </div>
      </div>
    </div>
  
    
  <div class="comments">
    <div id="disqus_thread" />
    <script>
      (function () {
        var d = document, s = d.createElement('script');
        s.src = 'https://shuheikagawa.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
      })();
    </script>
    <noscript>
      Please enable JavaScript to view the
      <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
    </noscript>
  </div>

  
        </div>
        <footer class="footer">
          Â© Shuhei Kagawa
        </footer>
      </div>
    </body>
  </html>